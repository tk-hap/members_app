{% extends "base.xml" %}
{% load static %}

{% block styles %}
  {% include "exercise_class/styles.xml" %}
{% endblock %}


{% load tz %}
{% get_current_timezone as TIME_ZONE %}
{% localtime on %}

{% block header %}
<image style="appbar-gym-logo" source="{% static 'gym/example-logo.png' %}"/>
<text style="appbar-headline-centered">Classes</text>
{% endblock %}

<form id="class-date">
  <date-field
    id="date-picker"
    name="date"
    placeholder="Select Date"
    label-format="MMMM DD, YYYY"
    value="Select date"
  >
    <behavior trigger="change" verb="get" href="{% url 'classes-for-day' %}" action="push"/>
  </date-field>
</form>
{% block content %}
<section-list id="class-list" sticky-section-titles="true">
{% for date, classes in exercise_classes.items %}
  <section-title>
    <text style="day-indicator">{{ date }}</text>
  </section-title>
  {% for class in classes %}
    <item style="class-item" key="{{ class.id }}" href="{% url 'exercise-class-detail' class.id %}">
      <image style="item-avatar" source="{{ class.event.trainer.picture_thumbnail.url }}"/>
      <view style="class-item-text">
        <text style="item-headline">{{ class.event.class_name }}</text>
        <text style="item-supporting-text">Trainer - {{ class.event.trainer }}</text>
      {% if class.participants.count >= class.max_participants %}
        <text style="item-supporting-text">Unavailable</text>
      {% else %}
        <text style="item-supporting-text">Available</text>
      {% endif %}
      </view>
      <text style="item-supporting-text-trailing">{{ class.event.start_time }}</text>
    </item>
  {% endfor %}
{% endfor %}  
</section-list>
{% endblock %}
{% block footer %}
  {% include "navbar.xml" with selected_tab="classes" %}
{% endblock %}
{% endlocaltime %}